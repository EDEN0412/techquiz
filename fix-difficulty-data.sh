#!/bin/bash

# Supabaseé›£æ˜“åº¦ãƒ‡ãƒ¼ã‚¿ä¿®æ­£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
echo "ğŸ”§ Supabaseã®é›£æ˜“åº¦ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä¿®æ­£ä¸­..."

# Supabaseãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
if ! supabase status | grep -q "API URL"; then
    echo "âŒ Supabaseãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“"
    echo "ã¾ãš 'supabase start' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
    exit 1
fi

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ
echo "ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°ä¸­..."
supabase db push

# æ›´æ–°ã•ã‚ŒãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨
echo "ğŸ”„ é›£æ˜“åº¦ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ä¿®æ­£ä¸­..."
supabase db reset --linked=false

echo "âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¿®æ­£ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
echo ""
echo "æ¬¡ã®æ‰‹é †ï¼š"
echo "1. Djangoé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•: python backend/manage.py runserver"
echo "2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•: npm run dev"
echo "3. ãƒ–ãƒ©ã‚¦ã‚¶ã§é›£æ˜“åº¦é¸æŠç”»é¢ã‚’ãƒ†ã‚¹ãƒˆ"
